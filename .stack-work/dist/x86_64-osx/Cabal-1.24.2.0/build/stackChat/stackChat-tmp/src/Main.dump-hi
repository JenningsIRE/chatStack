
==================== FINAL INTERFACE ====================
2017-10-31 12:49:04.164294 UTC

interface main@main:Main 8002
  interface hash: 8ed3a082bbce4d4f751b3f789041b10c
  ABI hash: af84b56c1da402e87f5a650bbe88ea05
  export-list hash: 8505e732438b909a6da6b004d81dd5a1
  orphan hash: 693e9af84d3dfcc71e640e005bdc5e2e
  flag hash: 4a911ef96c2b9d76f64eec71abf04ce6
  sig of: Nothing
  used TH splices: False
  where
exports:
  Main.broadcast
  Main.checkAddClient
  Main.handleMessage
  Main.kick
  Main.main
  Main.newClient
  Main.newServer
  Main.port
  Main.removeClient
  Main.runClient
  Main.sendMessage
  Main.sendToName
  Main.talk
  Main.tell
  Main.Client{Main.Client clientHandle clientKicked clientName clientSendChan}
  Main.ClientName
  Main.Message{Main.Broadcast Main.Command Main.Notice Main.Tell}
  Main.Server{Main.Server clients}
module dependencies:
package dependencies: array-0.5.1.1@array-0.5.1.1
                      async-2.1.1.1@async-2.1.1.1-8yywY4inVGRLJSCg60gBXj base-4.9.1.0
                      containers-0.5.7.1@containers-0.5.7.1
                      deepseq-1.4.2.0@deepseq-1.4.2.0 ghc-prim-0.5.0.0
                      integer-gmp-1.0.0.1
                      network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz
                      stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve
orphans: base-4.9.1.0:GHC.Base base-4.9.1.0:GHC.Float
         network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network.Socket
         stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Monad.STM
family instance modules: base-4.9.1.0:Control.Applicative
                         base-4.9.1.0:Data.Complex base-4.9.1.0:Data.Either
                         base-4.9.1.0:Data.Functor.Const base-4.9.1.0:Data.Functor.Identity
                         base-4.9.1.0:Data.List.NonEmpty base-4.9.1.0:Data.Monoid
                         base-4.9.1.0:Data.Semigroup base-4.9.1.0:Data.Type.Equality
                         base-4.9.1.0:Data.Version base-4.9.1.0:Data.Void
                         base-4.9.1.0:GHC.Exts base-4.9.1.0:GHC.Generics
                         base-4.9.1.0:GHC.IO.Exception base-4.9.1.0:GHC.TypeLits
                         containers-0.5.7.1@containers-0.5.7.1:Data.Map.Base
                         containers-0.5.7.1@containers-0.5.7.1:Data.Set.Base
import  -/  async-2.1.1.1@async-2.1.1.1-8yywY4inVGRLJSCg60gBXj:Control.Concurrent.Async ea0392541014747b7209d5d4a7804b6a
import  -/  base-4.9.1.0:Control.Concurrent 2ee6a0a58489520b9a96d8fef10380fa
import  -/  base-4.9.1.0:Control.Exception a76dd9666251322fe34dbcca3a0817bf
import  -/  base-4.9.1.0:Control.Exception.Base 1e106916283856f4d9caeddab92cd861
import  -/  base-4.9.1.0:Control.Monad a6784c5dab0d75c63dabec5a37843f98
import  -/  base-4.9.1.0:Data.Foldable 3e0b6967a1da89945d0e2d47266337a2
import  -/  base-4.9.1.0:Data.Functor 5ab1dc703df5b482e77efb697833ca3c
import  -/  base-4.9.1.0:Data.OldList 27987919d8da2f92e3f472ca81f730f8
import  -/  base-4.9.1.0:GHC.Base c4231c43c07e46080a26bf94094c7aa1
import  -/  base-4.9.1.0:GHC.Conc.Sync 8d0a228e5fc4d8c110495066f4d52ea1
import  -/  base-4.9.1.0:GHC.IO eb504c57b397cf133849f8586f15dafb
import  -/  base-4.9.1.0:GHC.IO.Handle ba98a5b34d78cbf48b41fe58a3735c69
import  -/  base-4.9.1.0:GHC.IO.Handle.Text b65719f3b262b071ab1aabeb72fc9d8b
import  -/  base-4.9.1.0:GHC.IO.Handle.Types 17aa0e2ab137800e3a31992d780c071f
import  -/  base-4.9.1.0:GHC.Real 82e4e59051a13dba1da63e1e970a69e6
import  -/  base-4.9.1.0:GHC.Show a027f5ac24879eaba752f44aa90fe511
import  -/  base-4.9.1.0:Prelude 22dd289b8469a8fa8dc81cab7b237771
import  -/  base-4.9.1.0:System.IO c9de64c5f5407c4cf1c52500c4d15200
import  -/  base-4.9.1.0:Text.Printf 6701574960cd2af960fec5d940be0c25
import  -/  containers-0.5.7.1@containers-0.5.7.1:Data.Map 0fd5c8559af8bc4b6f38b9cf9ba5a467
import  -/  containers-0.5.7.1@containers-0.5.7.1:Data.Map.Base 8b155a212edaca6c85bcefe65a8bc505
import  -/  ghc-prim-0.5.0.0:GHC.Types 89f8de4f08018c9177c98d979eae0e45
import  -/  network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network e1c2bc629a33bc735be38b505b5877ff
import  -/  network-2.6.3.2@network-2.6.3.2-IsLM4TXcLoRI0fmmBYVyQz:Network.Socket.Internal 9f052186d90733a29fe9bf6bf8921c1c
import  -/  stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Concurrent.STM 3662559905a40ae5adbc3e935ac706c8
import  -/  stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Concurrent.STM.TChan 791cd378857d88a7ed4d753121139423
import  -/  stm-2.4.4.1@stm-2.4.4.1-JQn4hNPyYjP5m9AcbI88Ve:Control.Concurrent.STM.TVar 8271fdeaf6f41f205dbe31243cf91390
0da55b27e264f51fbd69e9369296dc27
  $tc'Broadcast :: GHC.Types.TyCon
8f9fbf801e30ab59d73897613aeecd35
  $tc'Client :: GHC.Types.TyCon
7a063f6337fdc0bbd523e688a96c5e86
  $tc'Command :: GHC.Types.TyCon
498b2e9959240788eeab6191b34c7ad3
  $tc'Notice :: GHC.Types.TyCon
c33a03737ecea32ff981762d8cb6667c
  $tc'Server :: GHC.Types.TyCon
fe26f9e48ccd660f517ae448ff39f87b
  $tc'Tell :: GHC.Types.TyCon
4010569a3c52514870e6c03b81b0be61
  $tcClient :: GHC.Types.TyCon
2c3a3e705a8df7d89887fa0dddf96761
  $tcMessage :: GHC.Types.TyCon
0c854e850b0ab69edef798a79b93ee61
  $tcServer :: GHC.Types.TyCon
83f529351410271e83fed952c86159e1
  $trModule :: GHC.Types.Module
2ae9bdacfd79a32bec2d5c1f45445bfe
  data Client
    = Client {clientName :: Main.ClientName,
              clientHandle :: GHC.IO.Handle.Types.Handle,
              clientKicked :: GHC.Conc.Sync.TVar
                                (GHC.Base.Maybe GHC.Base.String),
              clientSendChan :: Control.Concurrent.STM.TChan.TChan Main.Message}
fbed4067a26e1dec37a31b9eba546428
  type ClientName = GHC.Base.String
5dbd4a2359c929efd03db7d129b982f9
  data Message
    = Notice GHC.Base.String
    | Tell Main.ClientName GHC.Base.String
    | Broadcast Main.ClientName GHC.Base.String
    | Command GHC.Base.String
79d39209b5cf42d422c300b408e9cbd8
  data Server
    = Server {clients :: GHC.Conc.Sync.TVar
                           (Data.Map.Base.Map Main.ClientName Main.Client)}
086468ab53146c36c5965cbc2af15289
  broadcast :: Main.Server -> Main.Message -> GHC.Conc.Sync.STM ()
bb6b985223837d734875d71cdf9fcea6
  checkAddClient ::
    Main.Server
    -> Main.ClientName
    -> GHC.IO.Handle.Types.Handle
    -> GHC.Types.IO (GHC.Base.Maybe Main.Client)
860684cda2a34e50a606b83faabff18f
  clientHandle :: Main.Client -> GHC.IO.Handle.Types.Handle
  RecSel Left Main.Client
b875d367c81148c5f319d54238d36da1
  clientKicked ::
    Main.Client -> GHC.Conc.Sync.TVar (GHC.Base.Maybe GHC.Base.String)
  RecSel Left Main.Client
e73b758db457da32249100aa724a1f60
  clientName :: Main.Client -> Main.ClientName
  RecSel Left Main.Client
1def096786d8b1c7205183f31ef1fbd2
  clientSendChan ::
    Main.Client -> Control.Concurrent.STM.TChan.TChan Main.Message
  RecSel Left Main.Client
eccf4cc90b60d3a7e615123a89dd12ff
  clients ::
    Main.Server
    -> GHC.Conc.Sync.TVar
         (Data.Map.Base.Map Main.ClientName Main.Client)
  RecSel Left Main.Server
3c4283e5d7e0efbb016788dada8c4a25
  handleMessage ::
    Main.Server
    -> Main.Client -> Main.Message -> GHC.Types.IO GHC.Types.Bool
61c0fa1ad7558125512a0fe9edd61d80
  kick ::
    Main.Server
    -> Main.ClientName -> Main.ClientName -> GHC.Conc.Sync.STM ()
0d166822e21f7182ece26123ea2cf341
  main :: GHC.Types.IO ()
080aa2dcae22d79bb2f4e52ca4b20a4c
  newClient ::
    Main.ClientName
    -> GHC.IO.Handle.Types.Handle -> GHC.Conc.Sync.STM Main.Client
c1954dd3b7a4f515728579792c7fc0f5
  newServer :: GHC.Types.IO Main.Server
3e851249960c65ce358c68fea5750b5a
  port :: GHC.Types.Int
a3f0ed00a566168c5179fb3b28a17dc5
  removeClient :: Main.Server -> Main.ClientName -> GHC.Types.IO ()
93723ac6ed943f74e8cfec5f95f6a08e
  runClient :: Main.Server -> Main.Client -> GHC.Types.IO ()
cb8ff6f98f967c72e06fca1c19e36106
  sendMessage :: Main.Client -> Main.Message -> GHC.Conc.Sync.STM ()
f20b91ef5b65be902a8a0c2c41a94981
  sendToName ::
    Main.Server
    -> Main.ClientName
    -> Main.Message
    -> GHC.Conc.Sync.STM GHC.Types.Bool
6a92744de9a0a95e4a51406e95bca304
  talk ::
    GHC.IO.Handle.Types.Handle -> Main.Server -> GHC.Types.IO ()
e64806f9d3f60abcde5f3ee4c7033a32
  tell ::
    Main.Server
    -> Main.Client
    -> Main.ClientName
    -> GHC.Base.String
    -> GHC.Types.IO ()
vectorised variables:
vectorised tycons:
vectorised reused tycons:
parallel variables:
parallel tycons:
trusted: none
require own pkg trusted: False

